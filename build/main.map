{"version":3,"sources":["webpack:///webpack/bootstrap 54810c4cb19a388f29a9","webpack:///./src/index.js","webpack:///external \"express\"","webpack:///external \"volleyball\"","webpack:///external \"dotenv/config\"","webpack:///external \"multer\""],"names":["upload","multer","app","express","SERVER_PORT","process","env","jws","bestMovies","use","json","urlencoded","extended","static","set","get","req","res","title","year","render","movies","post","fields","body","sendStatus","formData","console","log","newMovie","movietitle","movieyear","send","id","params","movieid","fakeUser","email","password","secret","myToken","jwt","sign","iss","user","role","favoriteMovie","favoriteMovieTheatre","lastLoginDate","Date","listen"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 54810c4cb19a388f29a9","import express from 'express'\nimport volleyball from 'volleyball'\nimport 'dotenv/config'\nimport multer from 'multer'\n\nconst upload = multer()\nconst app = express()\nconst { SERVER_PORT } = process.env\nconst jws = 'jsonwebtoken';\n\n\nlet bestMovies = [];\n\n//récuperer le contenu du formulaire grace à body-parser(inclut dans express)\napp.use(express.json());\napp.use(express.urlencoded({extended: true}));\n\n//config pour utiliser le template engine\napp.use('/public', express.static('public'));\napp.set('views', './views');    // 1er views = clef, 2eme = valeurs, \"les views dans le dossier views\"\napp.set('view engine', 'ejs');  // 1er = engine, 2eme = le type d'engine/'ejs, jade, pug, etc'\n                                // grace à la 2eme ligne, pas besoin d'extention '.ejs' lors d'appel de views dans le code\n\n//ma route movies\napp.get('/movies', (req, res) =>{\n\n  const title = 'Les meilleurs films de tous les temps';\n\n  bestMovies = [\n    { title: 'Retour vers le futur 2', year: 1989 },\n    { title: 'Toy Story 3', year: 2010 },\n    { title: 'Tampopo', year: 1985 },\n    { title: 'Drunken Master 2', year: 1994 }\n  ]\n  res.render('movies', { movies: bestMovies, title: title });\n})\n\napp.post('/movies', upload.fields([]), (req, res) => {\n    if(!req.body) {\n      return res.sendStatus(500);\n    } else {\n    const formData = req.body;\n    console.log('formData:', formData);\n    const newMovie = { title : req.body.movietitle, year: req.body.movieyear };\n    bestMovies = [... bestMovies, newMovie];\n    res.sendStatus(201);\n  }\n})\n\n//app.post('/movies', (req, res) =>{\n  //console.log('le titre :',req.body.movietitle);\n  //console.log('année :',req.body.movieyear);\n  //const newMovie = { title : req.body.movietitle, year : req.body.movieyear};\n  //bestMovies = [...bestMovies, newMovie]  //'...'' crées un nouveau tableau alors que push ajoute\n  //console.log(bestMovies);\n  //res.sendStatus(201);\n//})\n\n//formulaire pour ajouter un films                 // à mettre avant la route :id\napp.get('/movies/add', (req, res) =>{              // sinon conflit entre les deux\n  res.send('prochainement un formulaire ici');\n})\n\n//générateur de multiples routes\napp.get('/movies/:id/', (req, res) =>{    //les ':' + le nom de mon paramètre servent\n  const id = req.params.id;              //à créer de multiples routes automatiquement\n  const title = req.params.title\n  //res.send(`film numéro ${id}`);\n  res.render('movie-details', { movieid: id, movietitle: title });\n})\n\n//ma racine\napp.get('/', (req, res) =>{\n  res.render('index');                       // pour lier node à un template, toujours utiliser render()\n})\n\napp.get('/movie-search',(req, res) => {\n  res.render('movie-search');\n})\n\napp.get('/login',(req, res) =>{\n  res.render('login',{title : 'connexion'})\n})\n\nconst fakeUser = { email: 'testuser@gmail.fr', password: 'qsd' };\nconst secret = 'qsdjS12ozehdoIJ123DJOZJLDSCqsdeffdg123ER56SDFZedhWXojqshduzaohduihqsDAqsdq'\n\napp.post('/login', (req, res) =>{\n  console.log('login post', req.body);\n  if(!req.body){\n    const myToken = jwt.sign({iss: 'http://PopcornMovies.fr', user:'Bob', role:'Moderateur'})\n    res.sendStatus(500);\n  } else {\n      if(fakeUser.email === req.body.email && fakeUser.password === req.body.password) {\n        res.json({\n          email: 'testuser@gmail.fr',\n          favoriteMovie: 'Il était une fois en chine',\n          favoriteMovieTheatre: 'MK2 bibliothèque',\n          lastLoginDate: new Date()\n        });\n        res.json(myToken);\n      } else {\n        res.sendStatus(401);\n      }\n\n  }\n  }\n)\n\napp.listen( SERVER_PORT, (req,res)=>{\n  console.log(`Ca roule au port ${ SERVER_PORT }`)\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}